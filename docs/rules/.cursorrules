# Cursor AI Rules - Directory of Podiatrists

> **Nota:** Sincronizado con `CLAUDE.md`. Actualizar ambos simultÃ¡neamente.

## ğŸ¯ Proyecto

**Monorepo:** Directorio de podÃ³logos
- Frontend: Next.js 16 + React 19 + TypeScript + Tailwind
- Backend: NestJS 11 + Prisma 6 + PostgreSQL
- Package Manager: pnpm workspaces

## ğŸ“š Docs Obligatorias (LEER PRIMERO)

**Antes de implementar:**
1. [`docs/ai/rules.md`](./docs/ai/rules.md) - Reglas proyecto
2. [`docs/ai/context.md`](./docs/ai/context.md) - Contexto actual
3. [`docs/ai/conventions.md`](./docs/ai/conventions.md) - Convenciones cÃ³digo
4. [`docs/plans/README.md`](./docs/plans/README.md) - Planes desarrollo

**Para features:**
- Lee plan en `/docs/plans/0X-[nombre].md` completamente
- Cuestiona decisiones subÃ³ptimas
- PropÃ³n alternativas mejores
- Actualiza con decisiones tomadas

## ğŸ—ï¸ Arquitectura

**Backend (NestJS):**
- Modular (feature = mÃ³dulo)
- Prisma ORM
- JWT en cookies HTTP-only (NO localStorage)
- DTOs con `class-validator`
- `JwtAuthGuard` global + `@Public()` decorator

**Frontend (Next.js):**
- Server Components por defecto
- TypeScript strict
- Tailwind CSS (NO inline styles)
- Context API para estado
- Servicios en `/client/lib/services/`

## ğŸš« Nunca / âœ… Siempre

**âŒ NUNCA:**
JWT en localStorage | `any`/`unknown` | Commitear `.env` | Saltarse validaciÃ³n | Estilos inline | Implementar sin leer plan | Commits con refs a IA | Commits "hero"

**âœ… SIEMPRE:**
Leer docs | Cuestionar decisiones | Proponer alternativas | Actualizar planes | Type-safe | Validar (cliente + servidor) | Manejar errores | Tests 85% | Actualizar docs | Commits agrupados

## ğŸ“ Estructura

```
directory_of_podiatrists/
â”œâ”€â”€ server/src/          # Backend NestJS
â”‚   â”œâ”€â”€ auth/           # AutenticaciÃ³n
â”‚   â”œâ”€â”€ practitioners/  # Profesionales
â”‚   â””â”€â”€ prisma/         # DB service
â”œâ”€â”€ client/             # Frontend Next.js
â”‚   â”œâ”€â”€ app/           # App Router
â”‚   â”œâ”€â”€ components/    # Components
â”‚   â”œâ”€â”€ lib/services/  # API services
â”‚   â””â”€â”€ contexts/      # Context API
â””â”€â”€ docs/              # DocumentaciÃ³n
    â”œâ”€â”€ plans/         # Planes
    â”œâ”€â”€ project/       # Proyecto
    â””â”€â”€ ai/            # Config IA
```

## ğŸ”§ Comandos

```bash
pnpm install                        # Instalar
pnpm run dev                        # Dev completo
pnpm --filter server run dev:watch  # Backend
pnpm --filter client run dev        # Frontend

cd server
pnpm prisma migrate dev             # Migraciones
pnpm prisma db seed                 # Seed

pnpm --filter client run test       # Tests frontend
pnpm --filter server run test:e2e   # Tests e2e
```

## ğŸ¤” Proceso

1. Leer plan en `/docs/plans/`
2. Entender contexto
3. Revisar soluciÃ³n
4. Cuestionar si subÃ³ptimo
5. Proponer alternativas
6. Discutir si incertidumbre
7. Documentar decisiones
8. Implementar
9. Actualizar plan
10. Tests (85% coverage)
11. Commit

## ğŸ¨ Convenciones

- Interfaces (NO `type` sin razÃ³n)
- async/await (NO callbacks)
- const por defecto
- Arrow functions
- Template literals
- Optional chaining (`?.`) y nullish coalescing (`??`)

**Naming:**
- Componentes: `PascalCase`
- Funciones: `camelCase`
- Constantes: `UPPER_SNAKE_CASE`
- Utils: `kebab-case`

## ğŸ” Seguridad

- JWT en cookies HTTP-only con `sameSite: 'strict'`
- ValidaciÃ³n cliente + servidor
- Prisma queries parametrizadas
- CORS configurado
- NUNCA commitear secrets
- HTTPS en producciÃ³n

## ğŸ“ Commits

**Formato:** `type(scope): subject`

**Tipos:** `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`

**Ejemplos:**
```bash
feat(auth): add password reset
fix(search): improve performance
docs(plans): update auth plan
test(practitioners): add e2e tests
```

**âŒ NO:**
```bash
feat: implement entire system  # Hero
feat(auth): add login (co-authored with Cursor)  # Ref IA
fix: stuff  # Vago
```

## ğŸ“‹ Steps Development

**1. Pre-implementaciÃ³n:**
- â¬œ Leer plan `/docs/plans/0X-[nombre].md`
- â¬œ Entender contexto
- â¬œ Cuestionar approach

**2. ImplementaciÃ³n:**
- â¬œ Seguir convenciones
- â¬œ Validar cliente + servidor
- â¬œ Manejar errores

**3. Tests (OBLIGATORIO):**
- â¬œ Tests unitarios
- â¬œ Tests e2e
- â¬œ **85% coverage mÃ­nimo**
- â¬œ **Step NO completa si tests no pasan**

**4. Post-implementaciÃ³n:**
- â¬œ Actualizar plan
- â¬œ Actualizar `/docs/plans/README.md`
- â¬œ Commit
- â¬œ Marcar completado

**Actualizar docs:**
```bash
# 1. Actualizar plan (marcar tasks, aprendizajes)
# 2. Actualizar /docs/plans/README.md
# 3. Commit
git add docs/plans/
git commit -m "docs(plans): mark step 0X as completed"
```

## ğŸ”„ SincronizaciÃ³n

**IMPORTANTE:** Sincronizar con `CLAUDE.md`

Cuando actualices `.cursorrules` â†’ actualiza `CLAUDE.md` (y viceversa)

## ğŸ“– Recursos

- [Docs completa](./docs/README.md)
- [Planes](./docs/plans/README.md)
- [GuÃ­a IA](./docs/AI_COLLABORATION_GUIDE.md)
- [Arquitectura](./docs/project/architecture.md)

### Leyenda de Estados

- â¬œ Pendiente
- ğŸ”„ En progreso
- âœ… Completado

